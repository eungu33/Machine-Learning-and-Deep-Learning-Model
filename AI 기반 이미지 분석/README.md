# 감정 분석 기반 용의자 추론 시스템: Angry vs Neutral CNN 모델 개발

## ▣ 프로젝트 개요

딥러닝 기반 영상 분석 기술을 활용해  
**용의자의 마스크 착용 여부, 성별, 감정, 손글씨**를 종합 분류하고,  
이를 바탕으로 **사건 용의자를 추론하는 AI 시스템**을 구축하였습니다.

**특히, 본인은 ‘감정 분석 모듈’을 담당하여**  
**면담 영상 내 표정을 바탕으로 화남(Angry) vs 기본(Neutral)을 분류**하는  
CNN 기반 이진 감정 분류 모델을 개발하였습니다.

---

## ▣ 프로젝트 배경 및 목적

- 사건 현장의 **CCTV 이미지**, **면담 영상**, **현장 필기**를 함께 분석하여  
  **정황 근거 기반 AI 용의자 추론 시스템**을 구현

- 감정 분석은 용의자의 **심리 상태를 표정의 미세한 변화**로부터 추론하여  
  **의사결정 우선순위 판단**, **추가 조사 대상 선정** 등에 활용 가능

- CNN을 활용한 이진 분류 모델로  
  **Angry vs Neutral** 구분을 효과적으로 수행하여  
  **정밀하고 실용적인 감정 분석 시스템**을 구축하는 것이 목표

---

## ▣ 활용 데이터셋

- **FER2013 Dataset (Kaggle)**  
- 48x48 픽셀의 흑백 정면 표정 이미지  

| 클래스 | 이미지 수 |
|--------|------------|
| 기본(Neutral) | 4,965장 |
| 화남(Angry)   | 2,999장 |
| 총합          | 약 8,964장 |

---

## ▣ 프로젝트 진행 과정

### 1. 데이터 증강 및 전처리  
- 클래스 불균형 해소를 위해 다음 증강 기법 적용:
  - `RandomHorizontalFlip`, `RandomRotation`  
  - `ColorJitter`, `GaussianBlur`  
- 이미지 전처리:  
  - Resize(48x48)  
  - Tensor 변환 + 정규화

### 2. CNN 모델 구조 설계

- 3-Block Feature Extractor  
  - `Conv2d → BatchNorm → ReLU → MaxPool → Dropout`

- Classifier 구조  
  - `AdaptiveAvgPool`  
  - `Linear → ReLU → Dropout → Linear`

### 3. 학습 및 검증  
- Loss: `CrossEntropyLoss`  
- Optimizer: `AdamW`  
- Scheduler: `OneCycleLR`  
- 조기 종료: `EarlyStopping`  
- 모델 자동 저장: `torch.save()` 기반 best model 저장

### 4. 평가  
- `classification_report`, `confusion_matrix` 사용  
- Precision, Recall, F1 중심 분석

---

## ▣ 담당 역할

- 전체 감정 분류 모델 학습 코드 설계 및 구현  
  → `emotion_cnn_model.py` 작성

- **이진 분류 기준 설계** (기본 vs 화남)  
- 증강 파이프라인 설정 및 실험  
- EarlyStopping 적용 후 100 epoch 내 **최적 성능 확보**  
- Confusion Matrix 시각화 및 리포트 출력  
- 감정 분류 결과를 활용한 **용의자 추론 시나리오 작성**

---

## ▣ 분석 결과 요약

| 항목                        | 결과 |
|-----------------------------|------|
| 최종 테스트 정확도           | 84.45% |
| Angry vs Neutral precision  | 높음 |
| 다중 감정 분류 확장 시 정확도 | 60~70% 수준 (성능 저하) |
| 모델 성능 요인              | 밝기·대비·조도 민감 / 이진 분류에 적합한 Angry 특징 |

- CNN 구조만으로도 **자극적 감정(Angry)** 탐지에 강한 분별력 확보  
- **이진 분류 전략이 다중 감정 분류보다 실용성과 안정성 측면에서 유리**

---

## ▣ 주요 인사이트

- 감정 분석은 단순 표정보다 **시각적 노이즈 요소(조도, 밝기)**에 민감  
- **Angry 감정은 근육 긴장, 눈썹 모양, 이마 주름 등 특징이 명확해 탐지 용이**  
- 모델보다는 **데이터 전처리, 증강 설계**가 정확도에 직접 영향  
- 감정 결과는 단독 분석보다 **다른 요소와 결합해 용의자 추론 근거로 활용**될 때 효과적
