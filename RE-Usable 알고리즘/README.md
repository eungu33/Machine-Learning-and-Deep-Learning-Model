# 리유저블 컵 영상 기반 자동 분류 시스템 개발

## ▣ 프로젝트 개요

플라스틱 리유저블 컵의 자원 순환 과정을 자동화하기 위한  
**영상 기반 분류 시스템**을 개발하였습니다.

**컵의 상태**  
- 마크 식별  
- 파손 여부  
- 세척 상태  
- 브랜드 구분  
- 로고 손상도  

를 기준으로 **재활용 vs 폐기 vs 재프린팅** 여부를 자동 판단하는  
**전체 파이프라인을 구현**하였습니다.

---

## ▣ 프로젝트 배경 및 목적

- 리유저블 컵은 **환경 친화적 대안**이지만 회수율이 낮고  
  **분류 기준이 불명확**하여 **수작업 의존도가 높음**

- 실제 회수 및 검사 과정의 자동화 필요성이 제기되며,  
  **영상처리 + 머신러닝 기반 자동 판단 시스템 구축**이 목표

---

## ▣ 활용한 데이터 및 방식

- 팀원 직접 촬영한 **리유저블 컵 이미지·영상 데이터셋**  
- 주요 활용 기법:  
  - Adaptive Thresholding  
  - HOG + QDA  
  - 히스토그램 분석  
  - Edge Detection  
  - 템플릿 매칭  
  - 영상 프레임 추출 및 흐림도 분석  

- 각 모듈별 **자체 라벨링 및 기준 수립**

---

## ▣ 프로젝트 진행 과정

### 1. 리유저블 컵 여부 판별  
- **Adaptive Mean Thresholding**  
- `NuSVC` 기반 마크 유무 분류

### 2. 컵 파손 여부 판단  
- **HOG 기반 윤곽선 추출 + 정규화**  
- **QDA 모델**로 파손/정상 분류

### 3. 컵 세척 상태 확인  
- **그레이스케일 히스토그램** 분석  
- **Logistic Regression**으로 깨끗함/더러움 분류

### 4. 브랜드 구분  
- 수동 ROI 선택 → **Canny Edge**  
- **SVM**으로 디저트39 vs 스탠리 구분

### 5. 로고 손상도 분석 및 재프린팅 판단  
- `logo_frame_extraction.py`:  
  영상에서 로고 프레임 자동 추출 (matchTemplate + CLAHE + Blur 활용)

- `reprint_prediction_model.py`:  
  **노이즈 주입 시뮬레이션**으로 흐림 이미지 생성  
  → `RandomForestClassifier` 기반 재프린팅 판단 모델 학습  
  → `predict_one_image()` 함수로 테스트 가능

---

## ▣ 담당 역할

- **로고 프레임 추출 자동화 시스템 구현**  
  - `matchTemplate`, `CLAHE`, GaussianBlur, ROI 기반 탐색 전략

- **흐림 이미지 생성 시뮬레이터 구현**  
  - 다양한 수준의 노이즈 주입 방식 설계 및 자동 라벨링

- **RandomForest 기반 로고 흐림도 분류기 설계**  
  - Cut-off 조건 설정 포함  
  - 모델 저장 및 자동 분류 파이프라인 연결 (`joblib`)

---

## ▣ 분석 결과 요약

| 항목                   | 결과 요약 |
|------------------------|-----------|
| 템플릿 매칭 정확도    | CLAHE, Blur, 다중 스케일 탐색으로 향상 |
| 흐림도 예측 정확도    | 90% 이상 (RandomForest 기준) |
| 전체 시스템 안정성     | D안 전처리 기준 높은 수렴 안정성 확보 |
| 예측 결과 활용         | `predict_one_image()` 함수 및 영상 연계 가능 |

- **영상 흐름 내 프레임 분석 중심의 실용적 판단 시스템 구현**  
- 간단한 임계값 조정 + 머신러닝 모델 조합으로도 **고정밀 판단 가능**  
- 데이터 전처리와 **시뮬레이션 설계(노이즈 주입 등)**의 영향력이 매우 큼

---

## ▣ 주요 인사이트

- **단일 이미지 분석보다 영상 기반 프레임 탐색이 더 효과적**  
- 고정된 딥러닝 모델 없이도  
  **전처리 + 시뮬레이션 + 간단 모델 조합으로 높은 성능 달성 가능**  
- 리유저블 컵 외에도 다양한 **자원 회수·품질 판단 자동화 시스템**으로 확장 가능
